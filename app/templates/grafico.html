<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Método Gráfico - Programación Lineal</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'simplex.css' %}">
</head>
<body>

<!-- Menú lateral -->
<nav class="sidebar" id="sidebar">
    <button class="close-btn" onclick="toggleSidebar()">×</button>
    <ul>
        <li><h3 style="color: white; text-align: center;">Modulo I</h3></li>
        <li><a href="{% url 'home' %}">Home</a></li>
        <li><a href="{% url 'simplex' %}">Método Simplex</a></li>
        <li><a href="{% url 'grafico' %}">Método Gráfico</a></li>
    </ul>
</nav>

<button class="hamburger" onclick="toggleSidebar()" style="color: white;">☰ Menú</button>

<header class="banner">
    <h1>Método Gráfico</h1>
</header>

<main class="contenido">
    <div class="form-container">

        <!-- Paso 1: seleccionar número de restricciones -->
        <form class="form-control" method="get" action="{% url 'grafico' %}">
            <h2>Generar formulario</h2>
            <label>Cantidad de restricciones:</label>
            <input type="number" name="num_restricciones" min="1" value="{{ num_restricciones }}" required>
            <button type="submit">Generar</button>
        </form>

        <!-- Paso 2: ingresar coeficientes -->
        {% if formulario_generado %}
        <form class="form-control" method="post" action="{% url 'grafico' %}">
            {% csrf_token %}
            <input type="hidden" name="num_restricciones" value="{{ num_restricciones }}">

            <h2>Función objetivo (Z)</h2>
            <input type="number" step="any" name="c1" placeholder="Coeficiente x1" required>
            <input type="number" step="any" name="c2" placeholder="Coeficiente x2" required>

            <h2>Restricciones</h2>
            {% for r in restricciones %}
                <div class="restriccion">
                    <span>Restricción {{ r|add:'1' }}:</span>
                    <input type="number" step="any" name="r{{ r }}x1" placeholder="Coef x1" required>
                    <input type="number" step="any" name="r{{ r }}x2" placeholder="Coef x2" required>
                    <span> ≤ </span>
                    <input type="number" step="any" name="r{{ r }}b" placeholder="Valor RHS" required>
                </div>
            {% endfor %}

            <button type="submit">Graficar</button>
        </form>
        {% endif %}

        <!-- Resultado con gráfica -->
        {% if resultado %}
        <div id="resultado">
            <h2>Resultados</h2>
            {{ resultado|safe }}
            {% if grafico %}
                <img src="data:image/png;base64,{{ grafico }}" 
                     alt="Gráfico de programación lineal" 
                     style="max-width:100%; margin-top:20px; border:2px solid #226199; border-radius:10px;">
            {% endif %}
        </div>
        {% endif %}
    </div>
</main>

<script>
function toggleSidebar() {
    document.getElementById("sidebar").classList.toggle("active");
}
</script>

</body>
</html>
